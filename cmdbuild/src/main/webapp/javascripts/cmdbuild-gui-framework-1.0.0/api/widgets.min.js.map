{"version":3,"sources":["standard/widgets/LinkCards.js","standard/widgets/ManageEmail.js","standard/widgets/OpenAttachment.js"],"names":["$","LinkCards","saveMethod","Cmdbuild","widgets","SAVEONCARD","save","form","widget","formName","this","formObject","dataModel","forms","output","key","checked","name","_id","cleanData","cleanForm","jQuery","ManageEmail","ROWBUTTONREGENERATE","ROWBUTTONREPLY","ROWBUTTONDELETE","ROWBUTTONMODIFY","mailAttributes","template2MailTable","account","bccAddresses","content","toAddresses","ccAddresses","fromAddress","subject","SAVEAFTER","data","getBackendData","mails","bkData","bkMails","prepareFields","i","templates","length","template2Mail","evaluateCql","template","attributes","getAttributes","compileAttributes","CqlManager","variablesTable","generate","commandsTable","createField","widgetId","templateNumber","push","filter","text","params","variables","setSynchronization","keepSynchronization","promptSynchronization","compileAttribute","initialize","backendData","status","cqlResolve","loadMails","param","getBackend","refreshCqlField","initializationPhase","busy","id","pushSingleParameterOnStack","standard","commands","navigate","command","dialog","e","console","log","me","TM","setTimeout","backend","callback","callbackScope","cardId","utilities","proxy","getProcessMails","className","response","callbackLoadMails","apply","processType","processInstanceId","mail","splice","getProcessSingleMail","clone","ret","cqlResolveSingleField","nameField","resolve","getMail","fromTemplate","slice","cqlResolveCallback","attribute","refreshTemplate","templateName","isDifferent","bkMail","copyMail","mailOut","deleteMails","found","j","deleteProcessMail","type","flush","parentForm","Error","stack","arrMails","flushRecursive","present","grep","el","putProcessMail","postProcessMail","OpenAttachment","getAttachmentsForWidget","formname","widgetid","parentform","attachments","attachment","setAttachmentsForWidget","postInstanceAttachment","formdata"],"mappings":"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","file":"widgets.min.js"}