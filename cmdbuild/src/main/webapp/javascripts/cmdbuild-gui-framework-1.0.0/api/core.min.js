function waitingDialog(){$("#loadingScreen").show()}function closeWaitingDialog(){}!function(t){var e={localstorage_key:"CMDBuild-Authorization",types:{BASE:"base",SYSTEM:"system",PORTAL:"portal",URL:"url"},authenticationToken:null,lockedAuth:!1,getAuthenticationUrl:function(){return t.Cmdbuild.global.getApiUrl()+"sessions/"},setAuthenticationToken:function(t){this.authenticationToken=t},getAuthenticationToken:function(){var e=t.Cmdbuild.utilities.readCookie(t.Cmdbuild.access_token);return e?this.authenticationToken=e:!this.authenticationToken&&localStorage&&localStorage.getItem(this.localstorage_key)&&(this.authenticationToken=localStorage.getItem(this.localstorage_key)),this.authenticationToken},lockAuthentication:function(){this.lockedAuth=!0},unlockAuthentication:function(){this.lockedAuth=!1},isAuthLocked:function(){return this.lockedAuth},authenticate:function(){if(!this.isAuthLocked())switch(this.lockAuthentication(),t.Cmdbuild.global.getAuthenticationConfig().type){case this.types.BASE:this.baseAuthentication();break;case this.types.SYSTEM:this.systemAuthentication();break;case this.types.PORTAL:this.portalAuthentication();break;case this.types.URL:this.urlAuthentication();break;default:var e=new t.Cmdbuild.errorsManager.AuthenticationError("Please check authentication config.");t.Cmdbuild.errorsManager.popup(e)}},baseAuthentication:function(){var t={username:"admin",password:"admin"};this.doAuthenticate(t)},systemAuthentication:function(){var e={},i=t.Cmdbuild.global.getAuthenticationConfig();if(i.login&&i.login.username&&i.login.password)e.username=i.login.username,e.password=i.login.password,this.doAuthenticate(e);else{var r=t.Cmdbuild.global.getAppConfigUrl()+"auth.xml";t.Cmdbuild.utilities.getXmlDoc(r,this.systemAuthenticationXMLCB,this,{})}},systemAuthenticationXMLCB:function(e,i){if(e){var r=e.documentElement,a=t(r),n={};n.username=a.find(this.types.SYSTEM).find("username").text(),n.password=a.find(this.types.SYSTEM).find("password").text(),this.doAuthenticate(n)}},portalAuthentication:function(){var t={};this.doAuthenticate(t)},urlAuthentication:function(){var e=t.Cmdbuild.global.getAuthenticationConfig();urlconf=e.login.url;var i=this;t.ajax({type:urlconf.method?urlconf.method:"GET",url:urlconf.base,data:urlconf.params,cache:!1,success:function(t){i.onAuthenticationSuccess(t)},error:function(e,i,r){var a=new t.Cmdbuild.errorsManager.AuthenticationError;t.Cmdbuild.errorsManager.popup(a);var n="A problem occurred while authenticating. Please contact the administrator.";t.Cmdbuild.utilities.popupMessage("Authentication error",n)}})},doAuthenticate:function(e){var i=this,r=JSON.stringify(e);t.ajax({type:"POST",url:i.getAuthenticationUrl(),data:r,dataType:"json",contentType:"application/json",success:function(t){if(t){var e=t.data._id;i.onAuthenticationSuccess(e)}},error:function(e,i,r){var a=new t.Cmdbuild.errorsManager.AuthenticationError;t.Cmdbuild.errorsManager.popup(a)}})},onAuthenticationSuccess:function(e){this.setAuthenticationToken(e),this.unlockAuthentication(),t.Cmdbuild.utilities.startApplication()},getTokenFromLocalStorage:function(){return"undefined"!=typeof Storage?localStorage[this.localstorage_key]:void 0},setTokenToLocalStorage:function(t){"undefined"!=typeof Storage&&(localStorage[this.localstorage_key]=t)}};t.Cmdbuild.authentication=e}(jQuery),function(t){var e={AUTHENTICATION_HEADER:"CMDBuild-Authorization",contentType:"application/json",dataType:"json",loaderrequests:0,makeAjaxRequest:function(e,i,r,a,n){var o=t.Cmdbuild.authentication.getAuthenticationToken(),l=t.Cmdbuild.global.getLanguage();if(o){var s={};s[this.AUTHENTICATION_HEADER]=o,l&&(s["CMDBuild-Localized"]=!0,s["CMDBuild-Localization"]=l),n&&n===!0?this.noJSONAjaxRequest(e,i,r,a,s):this.directMakeAjaxRequest(e,i,r,a,s)}else t.Cmdbuild.authentication.authenticate()},directMakeAjaxRequest:function(e,i,r,a,n){var o=this;this.maskRequest(),t.ajax({type:i,url:e,data:a,cache:!1,dataType:this.dataType,crossDomain:!0,contentType:this.contentType,headers:n}).done(function(t){var e=t?t.data:void 0,i=t?t.meta:void 0;"function"==typeof r?r(e,i):r.success&&r.success(e,i)}).fail(function(t,i,n){"function"==typeof r?console.log("Ajax error = "+e+" -- ",a,Error().stack):r.fail&&r.fail()}).always(function(){"function"!=typeof r&&r.callback&&r.callback(),o.unmaskRequest()})},noJSONAjaxRequest:function(e,i,r,a,n){var o=this;this.maskRequest(),t.ajax({type:i,url:e,data:a,cache:!1,contentType:!1,processData:!1,headers:n}).done(function(t){"function"==typeof r?r(t):r.success&&r.success(t)}).fail(function(t,i,n){"function"==typeof r?console.log("Ajax error = "+e+" -- ",a,Error().stack):r.fail&&r.fail()}).always(function(){"function"!=typeof r&&r.callback&&r.callback(),o.unmaskRequest()})},maskRequest:function(){var e=t.Cmdbuild.global.getHtmlContainer().getAttribute("id");0===this.loaderrequests&&t("#"+e).waitMe({effect:"stretch",color:"#1c94c4"}),this.loaderrequests++},unmaskRequest:function(){var e=t.Cmdbuild.global.getHtmlContainer().getAttribute("id");this.loaderrequests--,0===this.loaderrequests&&t("#"+e).delay(500).waitMe("hide")}};t.Cmdbuild.authProxy=e}(jQuery),function(t){var e={context:[],push:function(t){this.context.push({container:t.container,form:t.form})},pop:function(t){for(var e=0;e<this.context.length;e++)t.container==this.context[e].container&&this.context.splice(e,this.context.length-e)},path:function(t){for(var e="",i=0;i<this.context.length&&(e+=this.context[i].container+"_",t.container!=this.context[i].container);i++);return e},getFormPath:function(t){for(var e=this.context.length-1;e>=0;e--)if(t==this.context[e].form)return this.path({container:this.context[e].container})}};t.Cmdbuild.standard.contextStack=e}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){function e(t){return l.raw?t:encodeURIComponent(t)}function i(t){return l.raw?t:decodeURIComponent(t)}function r(t){return e(l.json?JSON.stringify(t):String(t))}function a(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(o," ")),l.json?JSON.parse(t):t}catch(e){}}function n(e,i){var r=l.raw?e:a(e);return t.isFunction(i)?i(r):r}var o=/\+/g,l=t.cookie=function(a,o,s){if(void 0!==o&&!t.isFunction(o)){if(s=t.extend({},l.defaults,s),"number"==typeof s.expires){var d=s.expires,u=s.expires=new Date;u.setTime(+u+864e5*d)}return document.cookie=[e(a),"=",r(o),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}for(var c=a?void 0:{},m=document.cookie?document.cookie.split("; "):[],g=0,f=m.length;f>g;g++){var p=m[g].split("="),h=i(p.shift()),b=p.join("=");if(a&&a===h){c=n(b,o);break}a||void 0===(b=n(b))||(c[h]=b)}return c};l.defaults={},t.removeCookie=function(e,i){return void 0===t.cookie(e)?!1:(t.cookie(e,"",t.extend({},i,{expires:-1})),!t.cookie(e))}}),function(t){var e={insertChildren:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=this.toHtml(t.childNodes[i]);return e},toHtml:function(e){try{var i=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.MALFORMEDXMLNODE,element:e.nodeName});if("html"==e.nodeName)throw i;if("ldap"==e.nodeName)return"";if("rowButton"==e.nodeName)return"";if("columnsCommands"==e.nodeName)return"";if("#text"==e.nodeName)return"";if("onInit"==e.nodeName)return"";if("onDblClick"==e.nodeName)return"";if("onClick"==e.nodeName)return"";if("onChange"==e.nodeName)return"";if("params"==e.nodeName)return"";if("form"==e.nodeName)return"";if("openEntry"==e.nodeName)return"";if("#comment"==e.nodeName)return"";if("observe"==e.nodeName)return"";if("fields"==e.nodeName)return"";if("widgets"==e.nodeName)return"";if("buttons"==e.nodeName)return"";if(t.Cmdbuild.custom.elements&&t.Cmdbuild.custom.elements[e.nodeName]){var r=t.Cmdbuild.custom.elements[e.nodeName](e);return r}if(t.Cmdbuild.standard.elements[e.nodeName]){var r=t.Cmdbuild.standard.elements[e.nodeName](e);return r}console.log(e.nodeName+" not found!");var i=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.XMLTAGNOTDEFINED,element:e.nodeName});throw i}catch(a){var n="$.Cmdbuild.elementsManager.toHtml";throw t.Cmdbuild.errorsManager.log(n),t.Cmdbuild.errorsManager.log(a),a}return""},insertLoadingMask:function(t){var e="<div id='"+t+"'><h1>wait wait wait</h1></div>";return e},insertDialog:function(e,i){var r="<div id='"+e+"'></div>";return t.Cmdbuild.scriptsManager.push({script:"dialog",id:e,callback:i}),r},getText:function(e){var i=e.getAttribute("i18nText"),r=e.getAttribute("variableText"),a="";return a=t.Cmdbuild.utilities.escapeHtml(e.getAttribute("text")),r&&(a+=" "+t.Cmdbuild.dataModel.resolveVariable(r)),i?t.Cmdbuild.translations.getTranslation(i,a):a},getXmlElementId:function(t){var e=t.getAttribute("id");return e},getCommonAttributes:function(e){var i=" ",r=t.Cmdbuild.elementsManager.getXmlElementId(e);r&&(i+="id='"+r+"' ");var a=e.getAttribute("class");a&&(i+="class='"+a+"' ");var n=e.getAttribute("interactivity");n&&(i+="interactivity='"+n+"' ",i+=n==t.Cmdbuild.global.READ_ONLY?" disabled ":"");var o=e.getAttribute("title");o&&(i+="title='"+o+"' ");var l=e.getAttribute("formName");l&&(i+="formName='"+l+"' ");var s=e.getAttribute("fieldName");s&&(i+="fieldName='"+s+"' ");var d=e.getAttribute("height");d&&(i+="height='"+d+"' ");var u=e.getAttribute("width");u&&(i+="width='"+u+"' ");var c=e.getAttribute("tooltip");return c&&(i+="title='"+c+"' "),i},insertReturn:function(t){var e="",i=t.getAttribute("withReturn");return"true"==i&&(e+="<br/>"),e},isReturn:function(t){return"true"==t.getAttribute("withReturn")?!0:!1},insertLabel:function(e){var i=t.Cmdbuild.elementsManager.getXmlElementId(e),r=e.getAttribute("label"),a=e.getAttribute("i18nLabel");a&&(r=t.Cmdbuild.translations.getTranslation(a,r));var n=e.getAttribute("interactivity")||t.Cmdbuild.global.READ_WRITE,o=n==t.Cmdbuild.global.READ_WRITE_REQUIRED?"* ":"",l=e.getAttribute("classLabel"),s=" class='cmdbuildLabel"+(l?" "+l:"")+"'";return htmlStr="<label for='"+i+"'"+s+">"+o+r+"</label>",r?htmlStr:""},wrapInLayoutContainer:function(t,e){var i=t.getAttribute("labelPosition");return"over"==i?"<div class='cdmdbuildVboxContainer'>"+e+"</div>":e},wrapInRowContainer:function(e,i){var r=t.Cmdbuild.elementsManager.isReturn(e)?" cmdbuildBlockFormRow":"";return"<div class='cmdbuildFormRow"+r+"'>"+i+"</div>"},wrapInFormRow:function(e,i,r,a){var n=t("<dl></dl>").addClass("cmdbuildGuiFormRow").addClass("cmdbuildGuiFormRow-"+r);a&&n.addClass("cmdbuildGuiFormRowReadOnly");var o=t("<dt></dt>").html(e);e&&n.append(o);var l=t("<dd></dd>").html(i);return n.append(l),n.prop("outerHTML")},getEvent:function(e,i){var r={},a=t(i),n=a.children(e);return n.children().length?(r.id=a.attr("id"),n.children().each(function(e){var i=t(this).prop("tagName"),a=t(this).text();r[i]=a}),r):null},getGroupElements:function(e,i,r){r=r||{};var a=t(e),n=a,o=n.children(i);return o.children().each(function(e){var i=t(this).prop("tagName");if(!r[i]){var a=t(this).text();r[i]=a}}),t.isEmptyObject(r)?null:r},getRowButtons:function(e,i){var r=[],a=t(e);a.children("rowButton").each(function(e){r.push({id:t(this).attr("id"),tooltip:t(this).attr("tooltip"),className:t(this).attr("class"),onClick:t.Cmdbuild.elementsManager.getEvent("onClick",this),params:t.Cmdbuild.elementsManager.getParams(this)}),t.Cmdbuild.dataModel.prepareCallerParameters(t(this).attr("id"),t.Cmdbuild.elementsManager.getParams(this))}),i.rowButtons=r},getColumnsCommands:function(e,i){var r=[],a=t(e);a.children("columnsCommands").children("column").each(function(e,i){r.push({attribute:t(i).children("name").text(),icon:t(i).children("icon").text(),onClick:t.Cmdbuild.elementsManager.getEvent("onClick",this)})}),i.columnsCommands=r},getParams:function(t,e){return this.getGroupElements(t,"params",e)},isObserving:function(e,i){var r=this.getGroupElements(e,"observe");if(r){var a=e.getElementsByTagName("observe")[0].getAttribute("container");return t.Cmdbuild.dataModel.setObserver({container:a,form:i,fields:r}),!0}return!1},getElement:function(e){var i=t(t.Cmdbuild.global.getConfigurationDocument()),r=i.find("#"+e);if(!r){var a=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.XMLELEMENTNOTDEFINED,element:e});throw a}return r[0]},initialize:function(){t.Cmdbuild.scriptsManager.execute()},makeServiceButton:function(e,i,r,a){var n="";return n+="<button class='"+e+"' id='"+i+"' onclick='"+a+"'></button>",t.Cmdbuild.scriptsManager.push({script:"button",id:i,icon:r}),n},loadIconButtons:function(e,i,r){for(var a=0;a<i.length;a++){var n=t.Cmdbuild.dataModel.resolveVariables(i[a].params);if("false"!=n.condition){var o={type:"IMAGEBUTTON",displayableInList:!0,active:!0,name:i[a].id,className:i[a].className?i[a].className:i[a].id,tooltip:i[a].tooltip,onClick:JSON.stringify(i[a].onClick)};"left"==r?e.splice(a,0,o):e.push(o)}}},pushSelectionCheck:function(e,i){var r={type:"ROWSELECTIONCHECK",displayableInList:!0,active:!0,name:"selectionCheck",tooltip:t.Cmdbuild.global.SELECTIONTOOLTIP};"left"==i?e.splice(0,0,r):e.push(r)}};t.Cmdbuild.elementsManager=e}(jQuery),function(t){var e="An error is occured!";AuthenticationError=function(t){this.name="AuthenticationError",this.message=t||"Authentication error"},AuthenticationError.prototype=new Error,AuthenticationError.prototype.constructor=AuthenticationError;var i={isDialogOpen:!1,CMERROR:"cmError",ERROREXPLAINED:1,EVENTCOMMANDNOTFOUND:101,EVENTMETHODNOTDEFINED:102,INITNOTDEFINED:103,XMLTAGNOTDEFINED:201,MALFORMEDXMLNODE:202,BACKENDMETHODNOTDEFINED:301,FORMFIELDMETHODNOTDEFINED:401,AJAXERROR:501,AJAXERRORNOTFOUND:502,XMLELEMENTNOTDEFINED:601,MALFORMEDVARIABLE:602,SCRIPTNOTDEFINED:701,XMLFILENOTFOUND:801,XMLFILENOTCORRECT:802,PARAMNOTCORRECT:901,AUTHENTICATIONERROR:902,CONTAINERNOTFOUND:1001,CONFIGURATIONDOCUMENTNOTFOUND:1002,CLASSNOTFOUND:1101,CLASSNOTFOUND:1101,UNDEFINEDDEFAULTROLE:1201,AuthenticationError:AuthenticationError,strings:{0:"Errore {1} non riconosciuto",1:"{1}",101:"Non è definito l'elemento Command.\nElement Xml: {1}",102:"Comando non riconosciuto.\nElement Xml: {1}\nComando:{2}",103:"Init [ {1} {2} ] nella form [ {3} ] non definito",201:"Elemento {1} non definito",202:"Nodo Xml {1} non corretto",301:"Backend {1} non definito",501:"Ajax: errata richiesta.\nUrl: {1}",502:"Ajax: elemento non trovato nel Datatabase.\nUrl: {1}",601:"Elemento Xml [ {1} ] non presente nel file di configurazione",602:"Formato della variabile [ {1} ]\nerrato in [ {2} ]",701:"Script [ {1} ] non definito in {2}",801:"Xml file [ {1} ] non trovato",802:"Xml file [ {1} ] non corretto",901:"Parametro [ {1} {2} ] nella form [ {3} ] non corretto",902:"Credenziali di login non trovate: table {1} key {2} value {3}",1001:"Container Html non definito",1002:"Configuration [ {1} ] non definito",1101:"Classe [ {1} ] non trovata",1201:"Default role non definito per questo utente"},log:function(t){"object"==typeof t&&t.cmParam?console.log(t,t.cmParam.type,t.stack):"object"==typeof t?console.log(t,t.stack):console.log(t,t.stack)},warn:function(t){console.warn(t)},popupOnRequestFields:function(e){if(e.length>0){for(var i="",r=0;r<e.length;r++)i+="<p>",i+="Il campo "+e[r].field+" deve essere valorizzato",i+="</p>";var a=t("#errorDialog");return a.html(i),a.dialog("option","dialogClass",t.Cmdbuild.global.getThemeCSSClass()),a.dialog("option","title","Error!").dialog("open"),a.dialog("option","height",400),a.dialog("option","width",600),a.dialog("open"),!1}},popup:function(i){if(!this.isDialogOpen){this.isDialogOpen=!0,this.log(i);var r="";r+="<h2>"+e+"</h2>",i.message==this.CMERROR?(r+="<p>"+i.cmParam.type+"</p>",r+="<p>"+this.getErrorMessage(i)+"</p>"):r+="<p>"+i.message+"</p>";var a=t("#errorDialog");a.html(r),a.dialog("option","dialogClass",t.Cmdbuild.global.getThemeCSSClass()),a.dialog("option","title",i.name).dialog("open"),a.dialog("option","height",400),a.dialog("option","width",600),a.dialog("open")}},close:function(){this.isDialogOpen=!1},getErrorMessage:function(e){switch(e.cmParam.type){case this.ERROREXPLAINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.EVENTCOMMANDNOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.EVENTMETHODNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element,e.cmParam.method);case this.INITNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.param,e.cmParam.method,e.cmParam.element);case this.XMLTAGNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.MALFORMEDXMLNODE:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.BACKENDMETHODNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.AJAXERROR:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.AJAXERRORNOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.XMLELEMENTNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.MALFORMEDVARIABLE:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.variable,e.cmParam.element);case this.SCRIPTNOTDEFINED:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.XMLFILENOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.XMLFILENOTCORRECT:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.PARAMNOTCORRECT:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.param,e.cmParam.method,e.cmParam.element);case this.AUTHENTICATIONERROR:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.table,e.cmParam.key,e.cmParam.value);case this.CONTAINERNOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type]);case this.CONFIGURATIONDOCUMENTNOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.CLASSNOTFOUND:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type],e.cmParam.element);case this.UNDEFINEDDEFAULTROLE:return t.Cmdbuild.utilities.formatVarString(this.strings[e.cmParam.type]);default:return t.Cmdbuild.utilities.formatVarString(this.strings[0],e.cmParam.type,e.cmParam.element)}},getError:function(t){var e=new Error(t.message);return e.cmParam=t,e}};t.Cmdbuild.errorsManager=i}(jQuery),function(t){var e={events:[],deferred:0,onEvent:function(t){t&&(this.events.push(t),this.executeAllEvents())},deferEvents:function(){this.deferred++},unDeferEvents:function(){this.deferred--,this.executeAllEvents()},executeAllEvents:function(){if(!(this.deferred>0))for(;this.events.length>0;){var t=this.events[0];this.events.splice(0,1),this.executeEvent(t)}},executeEvent:function(e){try{if(!e.command){var i=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.EVENTCOMMANDNOTFOUND,element:e.id});throw i}if(t.Cmdbuild.dataModel.callerParameters[e.id]&&t.Cmdbuild.dataModel.pushParametersOnStack(e.id),t.Cmdbuild.custom.commands&&t.Cmdbuild.custom.commands[e.command])t.Cmdbuild.custom.commands[e.command](e);else{if(!t.Cmdbuild.standard.commands[e.command]){var i=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.EVENTMETHODNOTDEFINED,element:e.id,method:e.command});throw i}t.Cmdbuild.standard.commands[e.command](e)}}catch(r){throw t.Cmdbuild.errorsManager.log("$.Cmdbuild.eventsManager.executeEvent "+e.command),r}}};t.Cmdbuild.eventsManager=e}(jQuery),function(t){var e={CQLUNDEFINEDVALUE:"CMDBUILDUNDEFINEDFIELD",MAILSTATUSDRAFT:"draft",MAILSTATUSNEW:"new",MAILSTATUSOUTGOING:"outgoing",MAILSTATUSRECEIVED:"received",NOVALUEONREQUIREDFIELD:"NOVALUEONREQUIREDFIELD",LOOKUPPROCESSSTATUSES:"FlowStatus",STATE_VALUE_OPEN:"",STATE_VALUE_SUSPENDED:"open.not_running.suspended",STATE_VALUE_COMPLETED:"closed.completed",STATE_VALUE_ABORTED:"closed.aborted",STATE_VALUE_ALL:"all",PROCESS_STARTED:1,PROCESS_SUSPENDED:2,PROCESS_COMPLETED:3,PROCESS_STOPPED:4,PROCESS_INTERRUPTED:5,READ_WRITE_REQUIRED:"READ_WRITE_REQUIRED",READ_WRITE:"READ_WRITE",READ_ONLY:"READ_ONLY",htmlContainer:null,themeCSSClass:null,debugMode:void 0,ID_TAGS:["onClick > dialog","onClick > form","onClick > container","onClick > *[variableId='true']","onInit > dialog","onInit > form","onInit > container","onInit > *[variableId='true']","onChange > dialog","onChange > form","onChange > container","onInit > *[variableId='true']","params > *[variableId='true']","observe > *[variableId='true']"],ID_TAGSWITHVARIABLEATTRIBUTES:[["observe","container"]],WIDTH_REFERENCE:400,GRIDROWSCOUNT:"Page {1} of {2} (records {3})",GROUPOTHER:"Others",SELECTIONTOOLTIP:"Select element",maxLookupEntries:50,modalMaxHeight:600,modalMaxWidth:800,fieldInteractivityFromProcess:function(t,e){return t&&e?this.READ_WRITE_REQUIRED:t?this.READ_WRITE:this.READ_ONLY},fieldInteractivityFromCard:function(t){return t===!0?this.READ_WRITE_REQUIRED:this.READ_WRITE},getMaxLookupEntries:function(){return this.maxLookupEntries},setHtmlContainer:function(t){this.htmlContainer=t[0]},getHtmlContainer:function(){try{if(this.htmlContainer)return this.htmlContainer;var e=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.CONTAINERNOTFOUND});throw e}catch(i){throw t.Cmdbuild.errorsManager.log(i),i}},setConfigurationDocument:function(e,i){var r={callback:i};t.Cmdbuild.utilities.getXmlDoc(e,this.setConfigurationDocumentCB,this,r)},setConfigurationDocumentCB:function(t,e){this.configurationDocument=t,e.callback()},getConfigurationDocument:function(){try{if(this.configurationDocument)return this.configurationDocument;var e=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.CONFIGURATIONDOCUMENTNOTFOUND,element:""});throw e}catch(i){throw t.Cmdbuild.errorsManager.log(i),i}},setThemeCSSClass:function(t){this.themeCSSClass=t},getThemeCSSClass:function(){return this.themeCSSClass},setApiUrl:function(t){this.apiUrl=t},getApiUrl:function(){return this.apiUrl},setAppRootUrl:function(t){this.appRootUrl=t},getAppRootUrl:function(){return this.appRootUrl},setAppConfigUrl:function(t){this.appConfigUrl=t},getAppConfigUrl:function(){return this.appConfigUrl},setCqlUrl:function(t){this.cqlUrl=t},getCqlUrl:function(){return this.cqlUrl},setLanguage:function(t){this.language=t},getLanguage:function(){return this.language},setDebugMode:function(t){this.debugMode=t},isDebugMode:function(){return this.debugMode},setAuthenticationConfig:function(e){var i={};"string"==typeof e?i.type=e:"object"==typeof e&&e&&e.type?i=e:i.type=t.Cmdbuild.authentication.types.BASE,this.authConf=i},getAuthenticationConfig:function(){return this.authConf},configurationValue:function(e){var i=t.Cmdbuild.custom.configuration;if(i&&i[e])return i[e];var i=t.Cmdbuild.standard.configuration;return i&&i[e]?i[e]:void console.log("Not found config variable "+e)}};t.Cmdbuild.global=e}(jQuery),function(t){var e={configurator:void 0,variables:void 0,form:void 0,write:function(e){try{var i=function(t){console.log("cql.manager: "+t.msg)};this.form=e.form,this.configurator=new Configurator(i);var r=t.Cmdbuild.elementsManager.getElement(e.ldapDescriptor),a=this.getXmlValues(r,"fields","field");this.variables=this.getXmlValues(r,"variables","variable"),ldapRecord={},this.evaluateFields(a,ldapRecord,function(){ldapRecord=JSON.stringify(ldapRecord),t.Cmdbuild.utilities.proxyGuiServerSide.postLdap(ldapRecord,function(t){},this)},this)}catch(n){console.log("$.Cmdbuild.ldap.write "+n.message),t.Cmdbuild.errorsManager.popup(n)}},evaluateFields:function(e,i,r,a){try{if(e.length<=0)return void r.apply(a,[i]);var n=e[0];e.splice(0,1);var o=n.values.split(","),l=[n.format];this.evaluateSingleFields(o,l,function(){i[n.ldapName]=sprintf.apply(null,l),this.evaluateFields(e,i,r,a)},this)}catch(s){console.log("$.Cmdbuild.ldap.evaluateFields "+s.message),t.Cmdbuild.errorsManager.popup(s)}},evaluateSingleFields:function(e,i,r,a){try{if(e.length<=0)return void r.apply(a);var n=t.trim(e[0]);if(e.splice(0,1),"cql:"==(""+n).substr(0,4))this.resolveCql(n,function(t){i.push(t),this.evaluateSingleFields(e,i,r,a)},this);else{var o=t.Cmdbuild.dataModel.getValue(this.form,t.trim(n));i.push(o),this.evaluateSingleFields(e,i,r,a)}}catch(l){console.log("$.Cmdbuild.ldap.evaluateSingleFields "+l.message),t.Cmdbuild.errorsManager.popup(l)}},resolveCql:function(e,i,r){try{var a=(""+e).substr(4),n=a.split(".");if(2!=n.length)throw new t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.PARAMNOTCORRECT,param:"type",method:"ldap resolveCql",element:e});this.getVariable(n[0],function(t){this.resolveCqlCallback(t,n,i,r)},this)}catch(o){console.log("$.Cmdbuild.ldap.resolveCql "+o.message),t.Cmdbuild.errorsManager.popup(o)}},resolveCqlCallback:function(e,i,r,a){try{this.configurator.manager.cql.getValue("",e,function(n){if(n&&n.length<=0)throw new t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.PARAMNOTCORRECT,param:"type",method:"ldap resolveCql: Cql failed",element:e});var o="";n&&1==n.length&&(o=n[0][i[1]],"object"==typeof o&&(o=o.description)),r.apply(a,[o])},this)}catch(n){console.log("$.Cmdbuild.ldap.resolveCql "+n.message),t.Cmdbuild.errorsManager.popup(n)}},getVariable:function(e,i,r){for(var a=0;a<this.variables.length;a++)if(this.variables[a].key==e){var n={filter:this.variables[a].cql,meta:{},form:this.form};return void cqlEvaluate(n,function(t){i.apply(r,[t])},this)}throw new t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.PARAMNOTCORRECT,param:"type",method:"ldap resolveCql",element:"variable "+e+" not defined"})},getXmlValues:function(e,i,r){var a=t(e),n=a.find(i);if(n.length){for(var o=[],l=t(n[0]),s=0;s<l.children(r).length;s++){for(var d=t(l.children(r)[s]),u=d.children("*"),c={},m=0;m<u.length;m++){var g=t(u[m]),f=g.text(),p=g[0].tagName;c[p]=f}o.push(c)}return o}}};t.Cmdbuild.ldap=e}(jQuery),function($){var dataModel={model:[],observers:{},forms:{},formFields:{},callerParameters:{},parameters:{},widgets:{},attachments:{},processes:[],observing:!0,isAProcess:function(t){for(var e=0;e<this.processes.length;e++)if(this.processes[e]._id==t)return!0;return!1},cleanForm:function(t){this.forms[t]&&delete this.forms[t]},substituteWidgetWindow:function(t,e){this.widgets[t]=e},putWidgetWindow:function(t,e){this.widgets[t]=e},getWidgetWindow:function(t){return this.widgets[t]},prepareCallerParameters:function(t,e){$.Cmdbuild.dataModel.callerParameters[t]=e},pushSingleParameterOnStack:function(t,e){$.Cmdbuild.dataModel.parameters[t]=e},pushParametersOnStack:function(t){var e=$.Cmdbuild.dataModel.callerParameters[t];for(var i in e){var r=e[i];$.Cmdbuild.dataModel.parameters[i]=r}},getParameter:function(t){return $.Cmdbuild.dataModel.parameters[t]},deleteParameter:function(t){delete $.Cmdbuild.dataModel.parameters[t]},addFields:function(t,e){var i=[];for(var r in t)for(var a=0;a<e.length;a++){var n=e[a];if(r==n._id){n.displayableInList=!0;for(k in t[r])n[k]=t[r][k];i.push(n);break}}return i},evaluateFields:function(t,e){for(var i=[],r=this,a=0;a<e.length;a++){var n=e[a];for(var o in t)if(o==n._id){var l=t[o];if(jQuery.isEmptyObject(l)){n=null;break}if(l)for(var s in l)n[s]=r.resolveVariable(l[s]);break}n&&i.push(n)}return i},evaluateXmlAttributes:function(t,e){if($.Cmdbuild.dataModel.formFields[t]){var i=$.Cmdbuild.dataModel.getFormFields(t),r=i.fields,a="evaluate"==i.method?this.evaluateFields(r,e):this.addFields(r,e);e.splice(0,e.length);for(var n=0;n<a.length;n++)e.push(a[n])}},getFormFields:function(t){return $.Cmdbuild.dataModel.formFields[t]?$.Cmdbuild.dataModel.formFields[t]:void 0},putFormFields:function(t){t.fields?$.Cmdbuild.dataModel.formFields[t.form]=t:delete $.Cmdbuild.dataModel.formFields[t.form]},getCurrentIndex:function(t){return $.Cmdbuild.dataModel.model[t].currentIndex},setCurrentIndex:function(t,e){$.Cmdbuild.dataModel.model[t].currentIndex=e,$.Cmdbuild.dataModel.dispatchChange(t)},setValues:function(t,e){if(!$.Cmdbuild.dataModel.model[t])return{};var i=$.Cmdbuild.dataModel.model[t].currentIndex;return-1==i?{}:void(void 0!==i?$.extend($.Cmdbuild.dataModel.model[t].data[i],e):$.extend($.Cmdbuild.dataModel.model[t].data,e))},getData:function(t){return $.Cmdbuild.dataModel.model[t]&&$.Cmdbuild.dataModel.model[t].data?$.Cmdbuild.dataModel.model[t].data:[]},getValues:function(t){if($.Cmdbuild.standard.contextStack.getFormPath({form:t}),!$.Cmdbuild.dataModel.model[t])return"";var e=$.Cmdbuild.dataModel.model[t].currentIndex;return-1==e?"":void 0!==e?$.Cmdbuild.dataModel.model[t].data[e]:$.Cmdbuild.dataModel.model[t].data},getValue:function(t,e){if(!$.Cmdbuild.dataModel.model[t])return"";var i=$.Cmdbuild.dataModel.model[t].currentIndex;return-1==i?"":void 0!==i?$.Cmdbuild.dataModel.model[t].data[i][e]:$.Cmdbuild.dataModel.model[t].data[e]},push:function(t){try{$.Cmdbuild.dataModel.model[t.form]={type:t.type,currentIndex:t.currentIndex,data:t.data,backup:$.Cmdbuild.utilities.clone(t.data)}}catch(e){e.message+="\n$.Cmdbuild.dataModel.push",$.Cmdbuild.errorsManager.log(e)}},flush:function(t,e,i){try{t.data=$.Cmdbuild.dataModel.model[t.form].data,t.formObject.flush(t,function(r){$.Cmdbuild.dataModel.model[t.form].backup=$.Cmdbuild.utilities.clone($.Cmdbuild.dataModel.model[t.form].data),$.Cmdbuild.dataModel.dispatchChange(t.form),e.apply(i,[r])},this)}catch(r){throw $.Cmdbuild.dataModel.model[t.form].data=$.Cmdbuild.utilities.clone($.Cmdbuild.dataModel.model[t.form].backup),$.Cmdbuild.dataModel.reset(t),$.Cmdbuild.errorsManager.log("$.Cmdbuild.dataModel.flush"),r}},reset:function(t){try{t.data=$.Cmdbuild.dataModel.model[t.form].data,t.formObject.reset(t)}catch(e){throw $.Cmdbuild.errorsManager.log("$.Cmdbuild.dataModel.reset"),e}},change:function(t){try{t.data=$.Cmdbuild.dataModel.model[t.form].data;var e=t.formObject.change(t);if(e.length>0)return $.Cmdbuild.errorsManager.popupOnRequestFields(e),!1}catch(i){throw $.Cmdbuild.errorsManager.log("$.Cmdbuild.dataModel.change"),i}return!0},resolveParametersVariable:function(t){var e=$.Cmdbuild.dataModel.parameters[t],i=$.Cmdbuild.dataModel.resolveVariable(e);return i},resolveInterfaceVariable:function(t){var e=$.Cmdbuild.utilities.getHtmlFieldValue("#"+t);return e},resolveWindowVariable:function(field){return eval("window."+field)},resolveCMDBuildVariable:function(t){return $.Cmdbuild.customvariables[t]},resolveModelVariable:function(t,e){var i=$.Cmdbuild.dataModel.getValue(t,e);return i},resolveAnd:function(t){t=$.trim(t),t=t.substr(1),t=t.substr(0,t.length-1);for(var e=t.split(","),i=0;i<e.length;i++)if(!$.Cmdbuild.dataModel.resolveVariable($.trim(e[i])))return!1;return!0},resolveAnd:function(t){t=$.trim(t),t=t.substr(1),t=t.substr(0,t.length-1);for(var e=t.split(","),i=0;i<e.length;i++)if(!$.Cmdbuild.dataModel.resolveVariable($.trim(e[i])))return!1;return!0},resolveOr:function(t){t=$.trim(t),t=t.substr(1),t=t.substr(0,t.length-1);for(var e=t.split(","),i=0;i<e.length;i++)if($.Cmdbuild.dataModel.resolveVariable($.trim(e[i])))return!0;return!1},resolveNot:function(t){return t=$.trim(t),t=t.substr(1),t=t.substr(0,t.length-1),!$.Cmdbuild.dataModel.resolveVariable($.trim(t))},resolveVariable:function(t){var e="";if("$and"==(""+t).substr(0,4))e=$.Cmdbuild.dataModel.resolveAnd(t.substr(4));else if("$or"==(""+t).substr(0,3))e=$.Cmdbuild.dataModel.resolveOr(t.substr(3));else if("$not"==(""+t).substr(0,4))e=$.Cmdbuild.dataModel.resolveNot(t.substr(4));else if("$"==(""+t).substr(0,1)){
var i=t.substr(1),r=i.split(".");e=1==r.length?$.Cmdbuild.dataModel.resolveInterfaceVariable(r[0]):"parameters"==r[0]?$.Cmdbuild.dataModel.resolveParametersVariable(r[1]):"window"==r[0]?$.Cmdbuild.dataModel.resolveWindowVariable(r[1]):"cmdbuildvariables"==r[0]?$.Cmdbuild.dataModel.resolveCMDBuildVariable(r[1]):$.Cmdbuild.dataModel.resolveModelVariable(r[0],r[1])}else e=t;return e},resolveVariables:function(t){var e={};for(var i in t)e[i]=$.Cmdbuild.dataModel.resolveVariable(t[i]);return e},detachObserving:function(){this.observing=!1},attachObserving:function(){this.observing=!0},detachedObserving:function(){return!this.observing},dispatchChange:function(t){if(!$.Cmdbuild.dataModel.detachedObserving())try{var e={};for(var i in $.Cmdbuild.dataModel.observers)for(var r=0;r<$.Cmdbuild.dataModel.observers[i].fields.length;r++){var a=$.Cmdbuild.dataModel.observers[i].fields[r].form;t==a&&(e[i]||(e[i]={},e[i].fields=[],e[i].container=$.Cmdbuild.dataModel.observers[i].container),e[i].fields.push({tag:$.Cmdbuild.dataModel.observers[i].fields[r].tag,variable:"$"+t+"."+$.Cmdbuild.dataModel.observers[i].fields[r].field}))}for(var n in e){var o={};o.form=n,o.container=e[n].container,o.fromObserving="true";for(var r=0;r<e[n].fields.length;r++)o[e[n].fields[r].tag]=e[n].fields[r].variable;$.Cmdbuild.standard.commands.navigate(o)}}catch(l){throw $.Cmdbuild.errorsManager.log("$.Cmdbuild.dataModel.setObserver"),l}},setObserver:function(t){var e=[];try{for(var i in t.fields){if("$"!=(""+t.fields[i]).substr(0,1)){var r=$.Cmdbuild.errorsManager.getError({message:$.Cmdbuild.errorsManager.CMERROR,type:$.Cmdbuild.errorsManager.MALFORMEDVARIABLE,element:i,variable:t.fields[i]});throw r}var a=t.fields[i].substr(1),n=a.split(".");e.push({form:n[0],field:n[1],tag:i})}$.Cmdbuild.dataModel.observers[t.form]={},$.Cmdbuild.dataModel.observers[t.form].fields=e,$.Cmdbuild.dataModel.observers[t.form].container=t.container}catch(o){throw $.Cmdbuild.errorsManager.log("$.Cmdbuild.dataModel.setObserver"),o}},setAttachmentsForWidget:function(t,e){this.attachments[t]=e.slice()},addAttachmentForWidget:function(t,e){t in this.attachments||(this.attachments[t]=[]),this.attachments[t].push(e)},getAttachmentsForWidget:function(t){return t in this.attachments?this.attachments[t]:[]}};$.Cmdbuild.dataModel=dataModel}(jQuery),function(t){var e={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"},i={getBaseUrlCard:function(){return t.Cmdbuild.guiJavaUrlKey+"services/gui/ldapmanager/"},postLdap:function(i,r,a){var n=this.getBaseUrlCard();t.Cmdbuild.authProxy.makeAjaxRequest(n,e.POST,function(t){r.apply(a,[t])},i)}};t.Cmdbuild.utilities.proxyGuiServerSide=i}(jQuery),function(t){var e={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"},i={prepareParamsForList:function(t){var e={start:t.start?t.start:0};t.limit&&(e.limit=t.limit);var i=[];return t.sort&&(i.push({property:t.sort,direction:t.direction}),e.sort=JSON.stringify(i)),t.filter?e.filter=JSON.stringify(t.filter):e.filter="{query : ''}",t.active&&(e.active=t.active),t.positionOf&&(e.positionOf=t.positionOf),e},getURIForIconDownload:function(e){return t.Cmdbuild.global.getApiUrl()+"icons/"+e+"/image?CMDBuild-Authorization="+t.Cmdbuild.authentication.getAuthenticationToken()},getAttachmentsCategories:function(i,r){var a=t.Cmdbuild.global.getApiUrl()+"configuration/attachments/categories";t.Cmdbuild.authProxy.makeAjaxRequest(a,e.GET,function(t){i.apply(r,[t])})},getClassPrivileges:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"roles/"+i+"/classes_privileges/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t){a.apply(n,[t])})},getClassAttributes:function(i,r,a){var n=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/attributes";t.Cmdbuild.authProxy.makeAjaxRequest(n,e.GET,function(e){var i=[];t.each(e,function(t,e){e.active&&i.push(e)}),r.apply(a,[i])})},getFilteredCards:function(i,r,a){var n=this.prepareParamsForList(i),o=t.Cmdbuild.global.getApiUrl()+"classes";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){r.apply(a,[t,e])},n)},getCardList:function(i,r,a,n){var o=this.prepareParamsForList(r),l=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){a.apply(n,[t,e])},o)},getRelations:function(i,r,a,n){var o=this.prepareParamsForList(r),l=t.Cmdbuild.global.getApiUrl()+"domains/"+i+"/relations/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){a.apply(n,[t,e])},o)},getRelation:function(i,r,a,n,o){var l=this.prepareParamsForList(a),s=t.Cmdbuild.global.getApiUrl()+"domains/"+i+"/relations/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(s,e.GET,function(t,e){n.apply(o,[t,e])},l)},getDomains:function(i,r,a){var n=this.prepareParamsForList(i),o=t.Cmdbuild.global.getApiUrl()+"domains/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){r.apply(a,[t,e])},n)},getDomain:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"domains/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){r.apply(a,[t,e])},n)},getDomainAttributes:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"domains/"+i+"/attributes";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){r.apply(a,[t,e])},n)},getClass:function(i,r,a){var n={success:function(t,e){r.apply(a,[t,e])},fail:function(t){r.apply(a,[[],[]])}},o=t.Cmdbuild.global.getApiUrl()+"classes/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,n,{})},getClasses:function(i,r){var a=t.Cmdbuild.global.getApiUrl()+"classes/";t.Cmdbuild.authProxy.makeAjaxRequest(a,e.GET,function(t,e){i.apply(r,[t,e])},{})},deleteCard:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.DELETE,function(t,e){a.apply(n,[t,e])},{})},getCardData:function(i,r,a,n,o){var l=this.prepareParamsForList(a),s=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(s,e.GET,function(t,e){n.apply(o,[t,e])},l)},getCardAttachments:function(i,r,a,n,o){var l=this.prepareParamsForList(a),s=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards/"+r+"/attachments/";t.Cmdbuild.authProxy.makeAjaxRequest(s,e.GET,function(t,e){n.apply(o,[t,e])},l)},getLookupValue:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"lookup_types/"+i+"/values/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){n.apply(o,[t,e])},{})},getLookupType:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"lookup_types/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){a.apply(n,[t,e])},{})},getLookupData:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"lookup_types/"+i+"/values/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){a.apply(n,[t,e])},r)},getStepProcessAttributes:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/activities/"+a+"/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t){n.apply(o,[t])})},putProcessMail:function(i,r,a,n,o,l){var s=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/emails/"+a;t.Cmdbuild.authProxy.makeAjaxRequest(s,e.PUT,function(t){o.apply(l,[t])},JSON.stringify(n))},deleteProcessMail:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/emails/"+a;t.Cmdbuild.authProxy.makeAjaxRequest(l,e.DELETE,function(t){n.apply(o,[t])},{})},postProcessMail:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/emails/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.POST,function(t){n.apply(o,[t])},JSON.stringify(a))},getProcessMails:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/emails/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){a.apply(n,[t,e])},o)},getProcessSingleMail:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/emails/"+a+"/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t){n.apply(o,[t])})},getProcess:function(i,r,a){var n={success:function(t){r.apply(a,[t])},fail:function(t){r.apply(a,[[]])}},o=t.Cmdbuild.global.getApiUrl()+"processes/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,n)},getProcessAttributes:function(i,r,a){var n=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/attributes";t.Cmdbuild.authProxy.makeAjaxRequest(n,e.GET,function(e){var i=[];t.each(e,function(t,e){e.active&&i.push(e)}),r.apply(a,[i])})},getProcesses:function(i,r){var a=t.Cmdbuild.global.getApiUrl()+"processes/";t.Cmdbuild.authProxy.makeAjaxRequest(a,e.GET,function(t){i.apply(r,[t])})},getProcessStatuses:function(i,r){var a=t.Cmdbuild.global.getApiUrl()+"configuration/processes/statuses/";t.Cmdbuild.authProxy.makeAjaxRequest(a,e.GET,function(t){i.apply(r,[t])})},getStartProcessAttributes:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/start_activities/"+r+"/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t){a.apply(n,[t])})},getStartProcessActivities:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/start_activities/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t){a.apply(n,[t])})},getCardProcess:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r;t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){n.apply(o,[t,e])})},getActivity:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/activities/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t){a.apply(n,[t])})},getActivityList:function(i,r,a,n){var o=this.prepareParamsForList(r),l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t,e){a.apply(n,[t,e])},o)},putSession:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"sessions/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.PUT,function(){},JSON.stringify(r))},getSession:function(i,r,a,n){n||(n=[]);var o=t.Cmdbuild.global.getApiUrl()+"sessions/"+i;t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){n.push([t,e]),r.apply(a,n)},{})},postNewCard:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.POST,function(t){a.apply(n,[t])},JSON.stringify(r))},getSingleProcessInstance:function(i,r,a,n,o,l){var s=this.prepareParamsForList(a),d=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/";t.Cmdbuild.authProxy.makeAjaxRequest(d,e.GET,function(t){o.apply(l,callBackData,[t])},s)},abortProcess:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.DELETE,function(t){n.apply(o,[t])},JSON.stringify(a))},putStepProcess:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.PUT,function(t){n.apply(o,[t])},JSON.stringify(a))},postNewProcess:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.POST,function(t){a.apply(n,[t])},JSON.stringify(r))},postDomain:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"domains/"+i+"/relations/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.POST,function(t){a.apply(n,[t])},JSON.stringify(r))},putCard:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"classes/"+i+"/cards/"+r+"/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.PUT,function(t){n.apply(o,[t])},JSON.stringify(a))},putImpersonate:function(i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"sessions/"+i+"/impersonate/"+r+"/",l={success:function(t){a.apply(n,[!0])},fail:function(t){a.apply(n,[!1])}};t.Cmdbuild.authProxy.makeAjaxRequest(o,e.PUT,l)},getReports:function(i,r,a){var n=t.Cmdbuild.global.getApiUrl()+"reports/";t.Cmdbuild.authProxy.makeAjaxRequest(n,e.GET,function(t){r.apply(a,[t])})},getReportAttributes:function(i,r,a){var n=t.Cmdbuild.global.getApiUrl()+"reports/"+i+"/attributes";t.Cmdbuild.authProxy.makeAjaxRequest(n,e.GET,function(e){var i=[];t.each(e,function(t,e){e.active&&i.push(e)}),r.apply(a,[i])})},getInstanceAttachment:function(i,r,a,n,o){var l=t.Cmdbuild.global.getApiUrl()+"processes/"+i+"/instances/"+r+"/attachments/";t.Cmdbuild.authProxy.makeAjaxRequest(l,e.GET,function(t){n.apply(o,[t])})},postInstanceAttachment:function(e,i,r,a,n){var o=t.Cmdbuild.global.getApiUrl()+"processes/"+e+"/instances/"+i+"/attachments/",l={success:function(t,e){a.apply(n,[t,e])},fail:function(e){t.Cmdbuild.errorsManager.popup(new Error("The document is just saved")),a.apply(n,[e])}};t.Cmdbuild.authProxy.makeAjaxRequest(o,"POST",l,r,!0)},getCqlResults:function(i,r,a){var n=this.prepareParamsForList(i),o=t.Cmdbuild.global.getApiUrl()+"cql/",l=void 0;l="function"==typeof r?{success:function(t,e){r.apply(a,[t,e])},fail:function(t){r.apply(a,[[],[]])}}:r,t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,l,n)},getIcons:function(i,r,a){var n=this.prepareParamsForList(i),o=t.Cmdbuild.global.getApiUrl()+"icons/";t.Cmdbuild.authProxy.makeAjaxRequest(o,e.GET,function(t,e){r.apply(a,[t,e])},n)}};t.Cmdbuild.utilities.proxy=i}(jQuery),function(t){var e={arScripts:[],execute:function(){try{for(;this.arScripts.length>0;){var e=this.arScripts[0];this.arScripts.splice(0,1),this.executeScript(e)}}catch(i){throw t.Cmdbuild.errorsManager.log("$.Cmdbuild.scriptsManager.execute "+i.message,i.stack),i}},executeScript:function(e){if(t.Cmdbuild.custom.scripts&&t.Cmdbuild.custom.scripts[e.script])t.Cmdbuild.custom.scripts[e.script](e);else{if(!t.Cmdbuild.standard.scripts[e.script]){var i=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.SCRIPTNOTDEFINED,element:e.id,method:e.type});throw i}t.Cmdbuild.standard.scripts[e.script](e)}},push:function(t){this.arScripts.push(t)}};t.Cmdbuild.scriptsManager=e}(jQuery),function(t){function e(){var t=arguments[0],i=e.cache;return i[t]&&i.hasOwnProperty(t)||(i[t]=e.parse(t)),e.format.call(null,i[t],arguments)}function i(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function r(t,e){return Array(e+1).join(t)}var a={not_string:/[^s]/,number:/[dief]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fiosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};e.format=function(t,n){var o,l,s,d,u,c,m,g=1,f=t.length,p="",h=[],b=!0,C="";for(l=0;f>l;l++)if(p=i(t[l]),"string"===p)h[h.length]=t[l];else if("array"===p){if(d=t[l],d[2])for(o=n[g],s=0;s<d[2].length;s++){if(!o.hasOwnProperty(d[2][s]))throw new Error(e("[sprintf] property '%s' does not exist",d[2][s]));o=o[d[2][s]]}else o=d[1]?n[d[1]]:n[g++];if("function"==i(o)&&(o=o()),a.not_string.test(d[8])&&"number"!=i(o)&&isNaN(o))throw new TypeError(e("[sprintf] expecting number but found %s",i(o)));switch(a.number.test(d[8])&&(b=o>=0),d[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":case"i":o=parseInt(o,10);break;case"e":o=d[7]?o.toExponential(d[7]):o.toExponential();break;case"f":o=d[7]?parseFloat(o).toFixed(d[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&d[7]?o.substring(0,d[7]):o;break;case"u":o>>>=0;break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}!a.number.test(d[8])||b&&!d[3]?C="":(C=b?"+":"-",o=o.toString().replace(a.sign,"")),c=d[4]?"0"===d[4]?"0":d[4].charAt(1):" ",m=d[6]-(C+o).length,u=d[6]&&m>0?r(c,m):"",h[h.length]=d[5]?C+o+u:"0"===c?C+u+o:u+C+o}return h.join("")},e.cache={},e.parse=function(t){for(var e=t,i=[],r=[],n=0;e;){if(null!==(i=a.text.exec(e)))r[r.length]=i[0];else if(null!==(i=a.modulo.exec(e)))r[r.length]="%";else{if(null===(i=a.placeholder.exec(e)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){n|=1;var o=[],l=i[2],s=[];if(null===(s=a.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o[o.length]=s[1];""!==(l=l.substring(s[0].length));)if(null!==(s=a.key_access.exec(l)))o[o.length]=s[1];else{if(null===(s=a.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=s[1]}i[2]=o}else n|=2;if(3===n)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r[r.length]=i}e=e.substring(i[0].length)}return r};var n=function(t,i,r){return r=(i||[]).slice(0),r.splice(0,0,t),e.apply(null,r)};"undefined"!=typeof exports?(exports.sprintf=e,exports.vsprintf=n):(t.sprintf=e,t.vsprintf=n,"function"==typeof define&&define.amd&&define(function(){return{sprintf:e,vsprintf:n}}))}("undefined"==typeof window?this:window),function(t){var e={translations:{},loadTranslations:function(e,i){var r=this,a={callback:e,callbackScope:i},n=t.Cmdbuild.global.getLanguage();if(!n)return t.Cmdbuild.errorsManager.warn("No language selected"),void e.apply(i,[]);var o=t.Cmdbuild.global.getAppConfigUrl()+"translations/"+n+".xml";t.ajax({type:"HEAD",url:o}).done(function(){t.Cmdbuild.utilities.getXmlDoc(o,r.loadTranslationsCB,r,a)}).fail(function(){e.apply(i,[]),t.Cmdbuild.errorsManager.warn("No translation file found for language "+n.toUpperCase())})},loadTranslationsCB:function(e,i){var r=e.documentElement,a=t(r),n=this;t.each(a.children(),function(t,e){n.translations[e.tagName]=e.textContent});var o=i.callback,l=i.callbackScope;o.apply(l,[])},getTranslations:function(){return this.translations},getTranslation:function(e,i){if(this.getTranslations()&&this.getTranslations()[e])return this.getTranslations()[e];var r=t.Cmdbuild.global.getLanguage();return r&&t.Cmdbuild.errorsManager.warn("No translation found for label "+e+" into "+r.toUpperCase()+" language file"),i?i:e}};t.Cmdbuild.translations=e}(jQuery),function(t){var e={getXmlDoc:function(e,i,r,a){t.support.cors=!0,t.ajax({type:"GET",url:e,data:{},cache:!1,dataType:"xml",crossDomain:!0}).done(function(t){i.call(r,t,a)}).fail(function(t,e,i){console.log(t,e,i)}).always(function(){})},getLookupIdFromCode:function(e,i,r,a){var n=t.Cmdbuild.global.getApiUrl()+"lookup_types/"+e+"/values/";t.Cmdbuild.authProxy.makeAjaxRequest(n,"GET",function(t,e){for(var n=0;n<t.length;n++)if(t[n].code==i){r.apply(a,[t[n]._id]);break}},{})},removeAllChildren:function(t){for(var e;e=t.lastChild;)t.removeChild(e)},include:function(e,i,r,a){var n="";if(n=e.getAttribute("include"),!n)return void i.apply(a,[r]);var o=e.getAttribute("withId"),l=e.getAttribute("fileType");this.removeAllChildren(e);var s="";s=l&&"widget"===l?t.Cmdbuild.global.getAppRootUrl()+"widgets/"+n:t.Cmdbuild.global.getAppConfigUrl()+n,this.getXmlDoc(s,this.includeCB,this,{withId:o,xmlElement:e,callback:i,callbackParams:r,callbackScope:a})},includeCB:function(e,i){var r=e.documentElement;if(i.withId){var a=this;t(r).find("*[id]").each(function(){a.updateElementIds(r,this,i.withId)}),this.updateAttributeIds(r,i.withId)}for(var n=0;n<r.childNodes.length;n++)"#text"!=r.childNodes[n].nodeName&&"#comment"!=r.childNodes[n].nodeName&&i.xmlElement.appendChild(r.childNodes[n]);i.callback&&i.callback.apply(i.callbackScope,[i.callbackParams])},updateElementIds:function(e,i,r){var a=t(i).attr("id");t(i).attr("id",r+a);for(var n=0;n<t.Cmdbuild.global.ID_TAGS.length;n++){var o=t.Cmdbuild.global.ID_TAGS[n];t(e).find(o+":contains("+a+")").each(function(){var e=t(this).text();if("$"==e.substr(0,1)&&t.trim(e.substr(1))==a){t(this).text("$"+r+a);var i=e.split(".");i.length>1&&t(this).text(t(this).text()+i[1])}else if("$"==e.substr(0,1)){var i=e.split(".");t.trim(i[0].substr(1))==a&&i.length>1&&t(this).text("$"+r+a+"."+i[1])}else if(t.trim(e)==a)t(this).text(r+a);else{var i=e.split(".");i.length>1&&t.trim(i[n])==a&&t(this).text(i[0]+"."+r+a)}})}},updateAttributeIds:function(e,i){for(var r=0;r<t.Cmdbuild.global.ID_TAGSWITHVARIABLEATTRIBUTES.length;r++){var a=t.Cmdbuild.global.ID_TAGSWITHVARIABLEATTRIBUTES[r][0],n=t.Cmdbuild.global.ID_TAGSWITHVARIABLEATTRIBUTES[r][1];t(e).find(a).each(function(){var e=t(this).attr(n);t(this).attr(n,i+e)})}},getBackend:function(e){var i=t.Cmdbuild.utilities.getPathObject(e,t.Cmdbuild.custom.backend);if(i||(i=t.Cmdbuild.utilities.getPathObject(e,t.Cmdbuild.standard.backend)),!i){var r=t.Cmdbuild.errorsManager.getError({message:t.Cmdbuild.errorsManager.CMERROR,type:t.Cmdbuild.errorsManager.BACKENDMETHODNOTDEFINED,element:e});throw r}return i},getPathObject:function(t,e){if(!t)return null;for(var i=t.split("."),r=0;r<i.length;r++){if(!e[i[r]])return null;e=e[i[r]]}return e},formatVarString:function(){var t=[].slice.call(arguments);"[object Object]"!=this.toString()&&t.unshift(this.toString());var e=new RegExp("{([1-"+t.length+"])}","g");return String(t[0]).replace(e,function(e,i){return t[i]})},getFieldDescription:function(e,i,r,a){"reference"==e.type?t.Cmdbuild.utilities.proxy.getCardData(e.targetClass,i,{},function(t,e){r.apply(a,[t.Description])},this):"lookup"==e.type?t.Cmdbuild.utilities.proxy.getLookupValue(e.lookupType,i,{},function(t,e){r.apply(a,[t.description])},this):r.apply(a,[void 0])},getHtmlFieldValue:function(e){var i=t(e);if(i){if("SELECT"==i.prop("tagName")){var r=i.val();return r}if(i.attr("isDate")){var r=i.val(),a=i.attr("isDate");return r=t.Cmdbuild.utilities.convertDateGUI2DB(r,a)}if("spinner"==i.attr("valueType")){var r=i.spinner("value");return r}return"checkbox"==i.attr("type")?i.prop("checked")?!0:!1:i.val()}return null},convertDateGUI2DB:function(t,e){if("date"==e){var i=t.split("/");return 3==i.length?t=i[2]+"-"+i[1]+"-"+i[0]+"T00:00:00":""}return"time"==e?"1970-01-01T"+t:"dateTime"==e?t.replace("/","-"):t},convertDateDB2GUI:function(t,e){if(!t)return"";if("date"==e){var i=t.split("T");return i=i[0].split("-"),3==i.length&&(t=i[2]+"/"+i[1]+"/"+i[0]),t}if("time"==e){var i=t.split("T");return i[1]}return"dateTime"==e?t.replace("-","/"):t},getHtmlFieldInteractivity:function(e){var i=t(e);return i&&i.attr("interactivity")?i.attr("interactivity"):null},setAttributesInteractivity:function(e){for(var i=0;i<e.length;i++)e[i].interactivity=t.Cmdbuild.global.fieldInteractivityFromCard(e[i].isnotnull)},currentMenu:function(e,i){t("#"+i+" .ui-menu-item.selected").removeClass("selected"),t("#"+e).addClass("selected")},getEventLikeString:function(e,i,r){var a="";otherCommand=""|r;var n=t.Cmdbuild.elementsManager.getEvent(i,e);return n?a=" "+i+"='$.Cmdbuild.eventsManager.onEvent("+JSON.stringify(n)+");"+r+"' ":""},clone:function(t){return JSON.parse(JSON.stringify(t))},escapeHtml:function(t){if(!t)return"";var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"/"},i=String(t).replace(/[&<>"'\/]/g,function(t){return e[t]});return i},removeAttribute:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name==e){t.splice(i,1);break}return t},changeAttributeType:function(t,e,i){for(var r=0;r<t.length;r++)if(t[r].name==e){t[r].type=i;break}return t},sortAttributes:function(t){t.sort(function(t,e){return t.index-e.index})},insertOtherGroup:function(t,e){for(var i=!1,r=0;r<t.length;r++)if(t[r].group){i=!0;break}if(i)for(var r=0;r<t.length;r++)t[r].group||(t[r].group="Others");return t},startApplication:function(){t.Cmdbuild.custom.commands&&t.Cmdbuild.custom.commands.initialize?t.Cmdbuild.custom.commands.initialize(this.startApplicationCallBack):this.startApplicationCallBack()},startApplicationCallBack:function(){t.Cmdbuild.global.getHtmlContainer().innerHTML="";var e=t.Cmdbuild.global.getConfigurationDocument().documentElement,i=t.Cmdbuild.elementsManager.insertDialog("errorDialog",t.Cmdbuild.errorsManager.close);i+=t.Cmdbuild.elementsManager.insertChildren(e),t(t.Cmdbuild.global.getHtmlContainer()).attr("class",t.Cmdbuild.global.getThemeCSSClass()),t.Cmdbuild.global.getHtmlContainer().innerHTML=i,t.Cmdbuild.elementsManager.initialize(),t(document).tooltip()},getFields:function(e){var i=t(e),r=i.find("fields");if(r.length){var a={},n=t(r[0]),o=n.children("form").text();a.form=o;var l=n.children("method").text();if(a.method=l,0==n.children("field").length)return a;a.fields={};for(var s=0;s<n.children("field").length;s++){var d=t(n.children("field")[s]),u=d.children("name").text(),c={};if(u){for(var m=d.children("attributes"),g=0;g<m.children("attribute").length;g++){var f=t(m.children("attribute")[g]),p=f.children("name").text(),h=f.children("value").text();p&&(c[p]=h)}a.fields[u]=c}}return a}},getFormFields:function(e){var i=t(e),r=i.find("formFields");if(r.length){var a={},n=t(r[0]),o=n.children("form").text();if(a.form=o,0==n.children("field").length)return a;a.fields={};for(var l=0;l<n.children("field").length;l++){var s=t(n.children("field")[l]),d=s.children("name").text(),u={};if(d){for(var c=s.children("attributes"),m=0;m<c.children("attribute").length;m++){var g=t(c.children("attribute")[m]),f=g.children("name").text(),p=g.children("value").text();f&&(u[f]=p)}a.fields[d]=u}}return a}},addFields:function(){},getToday:function(){var t=new Date,e=t.getDate(),i=t.getMonth()+1,r=t.getFullYear();return e+"/"+i+"/"+r},getConditionsFromParam:function(e){var i=[];if(e.condition)for(var r=e.condition.split(","),a=0;a<r.length;a++){var n=r[a].split("="),o={field:n[0],value:t.Cmdbuild.dataModel.resolveVariable(n[1])};i.push(o)}return i},getAttributesFilterFromConditions:function(t){if(0!=t.length){for(var e={},i=[],r=0;r<t.length;r++){var a={simple:{attribute:t[r].field,operator:"equal",value:[t[r].value],parameterType:"fixed"}};i.push(a)}return e=1==t.length?i[0]:{and:i}}},getWidgetsFromXML:function(e){var i=[],r=t(e),a=r.children("widgets");return a.length&&0!=a.children("widget").length?(t.each(a.children("widget"),function(e,r){var a={};t.each(r.children,function(t,e){a[e.nodeName]=e.textContent}),i.push({_id:a.id,active:a.active,label:a.label,required:a.required,type:a.type,data:a})}),i):void 0},getButtonsFromXML:function(e){var i="",r=t(e),a=r.children("buttons"),n=a.length>0&&a.children("button").length>0;return n&&(i+='<div class="formButtons">'),t.each(a.children("button"),function(e,r){var a=new DOMParser;xDoc=a.parseFromString(r.outerHTML,"text/xml"),i+=t.Cmdbuild.elementsManager.toHtml(xDoc.documentElement)}),n&&(i+="</div>"),i},popupMessage:function(e,i){t("<div />").html(i).dialog({title:e,dialogClass:"no-close",dialogClass:t.Cmdbuild.global.getThemeCSSClass(),buttons:[{text:"OK",click:function(){t(this).dialog("destroy")}}]})},uniqueId:function(){return Math.round((new Date).getTime()+100*Math.random())},readCookie:function(t){for(var e=t+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var a=i[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null}};t.Cmdbuild.utilities=t.extend(t.Cmdbuild.utilities,e)}(jQuery);
//# sourceMappingURL=core.min.js.map